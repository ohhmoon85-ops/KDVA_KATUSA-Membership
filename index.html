<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <title>KDVA ê°€ì… - AKUS íšŒì› ì „ìš©</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 50%, #c41e3a 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 600px;
            width: 100%;
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 40px 30px;
            text-align: center;
        }

        .logo {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 20px;
            letter-spacing: 3px;
        }

        .slogan-ko {
            font-size: 22px;
            font-weight: bold;
            margin-bottom: 10px;
            line-height: 1.4;
        }

        .slogan-en {
            font-size: 16px;
            font-style: italic;
            opacity: 0.95;
            line-height: 1.4;
        }

        .content {
            padding: 40px 30px;
        }

        .badge {
            display: inline-block;
            background: linear-gradient(135deg, #c41e3a 0%, #a01830 100%);
            color: white;
            padding: 15px 35px;
            border-radius: 25px;
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 30px;
            box-shadow: 0 8px 20px rgba(196, 30, 58, 0.4);
            border: 3px solid #fff;
            letter-spacing: 1px;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
                box-shadow: 0 8px 20px rgba(196, 30, 58, 0.4);
            }
            50% {
                transform: scale(1.05);
                box-shadow: 0 12px 30px rgba(196, 30, 58, 0.6);
            }
        }

        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 600;
            font-size: 14px;
        }

        input[type="text"],
        input[type="email"],
        input[type="password"] {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            -webkit-appearance: none;
            appearance: none;
        }

        input[type="text"]:focus,
        input[type="email"]:focus,
        input[type="password"]:focus {
            outline: none;
            border-color: #2a5298;
        }

        .btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #c41e3a 0%, #a01830 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            margin-top: 10px;
            -webkit-appearance: none;
            appearance: none;
        }

        .btn:active {
            opacity: 0.8;
        }

        .success-message {
            display: none;
            background: #4CAF50;
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            margin-top: 20px;
            font-weight: bold;
        }

        .admin-link {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #e0e0e0;
        }

        .admin-link a {
            color: #2a5298;
            text-decoration: none;
            font-size: 14px;
            font-weight: 600;
            display: inline-block;
            padding: 10px;
        }

        .hidden {
            display: none;
        }

        .admin-header {
            background: #2a5298;
            color: white;
            padding: 30px;
            text-align: center;
        }

        .admin-content {
            padding: 30px;
        }

        .stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: #f5f5f5;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-number {
            font-size: 36px;
            font-weight: bold;
            color: #2a5298;
        }

        .stat-label {
            font-size: 14px;
            color: #666;
            margin-top: 5px;
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
        }

        .action-btn {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-weight: bold;
            font-size: 14px;
            -webkit-appearance: none;
        }

        .download-btn {
            background: #4CAF50;
            color: white;
        }

        .back-btn {
            background: #757575;
            color: white;
        }

        .members-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .members-table th {
            background: #2a5298;
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        .members-table td {
            padding: 15px;
            border-bottom: 1px solid #e0e0e0;
        }

        .no-data {
            text-align: center;
            padding: 40px;
            color: #999;
            font-style: italic;
        }

        @media (max-width: 600px) {
            .container {
                border-radius: 0;
            }

            .header {
                padding: 30px 20px;
            }

            .slogan-ko {
                font-size: 18px;
            }

            .slogan-en {
                font-size: 14px;
            }

            .content {
                padding: 30px 20px;
            }

            .badge {
                font-size: 18px;
                padding: 12px 30px;
            }

            .stats {
                grid-template-columns: 1fr;
            }

            .action-buttons {
                flex-direction: column;
            }

            .members-table {
                font-size: 14px;
            }

            .members-table th,
            .members-table td {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <!-- ê°€ì… í˜ì´ì§€ -->
    <div class="container" id="signupPage">
        <div class="header">
            <div class="logo">KDVA</div>
            <div class="slogan-ko">í•œë¯¸ë™ë§¹ì— ë‹¹ì‹ ì˜ í•œ í‘œë¥¼ ë”í•˜ì‹­ì‹œì˜¤</div>
            <div class="slogan-en">Add Your Vote to the ROK-US Alliance</div>
        </div>
        <div class="content">
            <div class="badge">â­ AKUS íšŒì› ì „ìš© â­</div>
            
            <form id="signupForm">
                <div class="form-group">
                    <label for="name">ì´ë¦„ (í•œê¸€) *</label>
                    <input type="text" id="name" name="name" placeholder="í™ê¸¸ë™" required>
                </div>
                
                <div class="form-group">
                    <label for="email">ì´ë©”ì¼ (Email) *</label>
                    <input type="email" id="email" name="email" placeholder="your.email@example.com" required>
                </div>
                
                <button type="submit" class="btn">ê°€ì…í•˜ê¸° (Join Now)</button>
            </form>

            <div class="success-message" id="successMessage">
                âœ“ ê°€ì…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!<br>
                í™˜ì˜í•©ë‹ˆë‹¤!
            </div>

            <div class="admin-link">
                <a href="javascript:void(0);" id="adminLink">ê´€ë¦¬ì ë¡œê·¸ì¸</a>
            </div>
        </div>
    </div>

    <!-- ê´€ë¦¬ì ë¡œê·¸ì¸ í˜ì´ì§€ -->
    <div class="container hidden" id="loginPage">
        <div class="admin-header">
            <h2>ê´€ë¦¬ì ë¡œê·¸ì¸</h2>
        </div>
        <div class="content">
            <form id="loginForm">
                <div class="form-group">
                    <label for="adminPassword">ë¹„ë°€ë²ˆí˜¸</label>
                    <input type="password" id="adminPassword" placeholder="ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ ì…ë ¥" required>
                </div>
                <button type="submit" class="btn">ë¡œê·¸ì¸</button>
                <div class="admin-link">
                    <a href="javascript:void(0);" id="backToSignup">ê°€ì… í˜ì´ì§€ë¡œ ëŒì•„ê°€ê¸°</a>
                </div>
            </form>
        </div>
    </div>

    <!-- ê´€ë¦¬ì í˜ì´ì§€ -->
    <div class="container hidden" id="adminPage">
        <div class="admin-header">
            <h2>íšŒì› ê´€ë¦¬ ëŒ€ì‹œë³´ë“œ</h2>
        </div>
        <div class="admin-content">
            <div class="stats">
                <div class="stat-card">
                    <div class="stat-number" id="totalMembers">0</div>
                    <div class="stat-label">ì´ íšŒì› ìˆ˜</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="todayMembers">0</div>
                    <div class="stat-label">ì˜¤ëŠ˜ ê°€ì…</div>
                </div>
            </div>

            <div class="action-buttons">
                <button class="action-btn download-btn" id="downloadExcel">
                    ğŸ“¥ ì—‘ì…€ ë‹¤ìš´ë¡œë“œ
                </button>
                <button class="action-btn download-btn" id="downloadCSV">
                    ğŸ“„ CSV ë‹¤ìš´ë¡œë“œ
                </button>
                <button class="action-btn back-btn" id="logoutBtn">
                    ğŸšª ë¡œê·¸ì•„ì›ƒ
                </button>
            </div>

            <div id="membersTableContainer">
                <table class="members-table">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>ì´ë¦„</th>
                            <th>ì´ë©”ì¼</th>
                            <th>ê°€ì…ì¼ì‹œ</th>
                        </tr>
                    </thead>
                    <tbody id="membersTableBody">
                        <tr>
                            <td colspan="4" class="no-data">ë“±ë¡ëœ íšŒì›ì´ ì—†ìŠµë‹ˆë‹¤.</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // ì „ì—­ ë³€ìˆ˜
        var members = [];
        var ADMIN_PASSWORD = 'kdvakr0420!';
        
        // localStorage ì•ˆì „í•˜ê²Œ ì‚¬ìš©
        function loadMembers() {
            try {
                var stored = localStorage.getItem('kdvaMembers');
                if (stored) {
                    members = JSON.parse(stored);
                    console.log('íšŒì› ë¡œë“œ:', members.length);
                }
            } catch (e) {
                console.log('localStorage ì‚¬ìš© ë¶ˆê°€:', e);
                members = [];
            }
        }
        
        function saveMembers() {
            try {
                localStorage.setItem('kdvaMembers', JSON.stringify(members));
                console.log('íšŒì› ì €ì¥:', members.length);
                return true;
            } catch (e) {
                console.log('localStorage ì €ì¥ ì‹¤íŒ¨:', e);
                return false;
            }
        }
        
        // í˜ì´ì§€ ì „í™˜
        function showPage(pageId) {
            console.log('í˜ì´ì§€ ì „í™˜:', pageId);
            var pages = ['signupPage', 'loginPage', 'adminPage'];
            for (var i = 0; i < pages.length; i++) {
                var page = document.getElementById(pages[i]);
                if (page) {
                    if (pages[i] === pageId) {
                        page.classList.remove('hidden');
                    } else {
                        page.classList.add('hidden');
                    }
                }
            }
        }
        
        // ëŒ€ì‹œë³´ë“œ ì—…ë°ì´íŠ¸
        function updateDashboard() {
            console.log('ëŒ€ì‹œë³´ë“œ ì—…ë°ì´íŠ¸');
            
            var totalEl = document.getElementById('totalMembers');
            if (totalEl) totalEl.textContent = members.length;
            
            var today = new Date().toDateString();
            var todayCount = 0;
            for (var i = 0; i < members.length; i++) {
                var memberDate = new Date(members[i].joinDate).toDateString();
                if (memberDate === today) todayCount++;
            }
            
            var todayEl = document.getElementById('todayMembers');
            if (todayEl) todayEl.textContent = todayCount;
            
            var tbody = document.getElementById('membersTableBody');
            if (tbody) {
                tbody.innerHTML = '';
                
                if (members.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="4" class="no-data">ë“±ë¡ëœ íšŒì›ì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
                } else {
                    for (var i = 0; i < members.length; i++) {
                        var member = members[i];
                        var date = new Date(member.joinDate);
                        var dateStr = date.toLocaleString('ko-KR');
                        
                        var row = tbody.insertRow();
                        row.insertCell(0).textContent = (i + 1);
                        row.insertCell(1).textContent = member.name;
                        row.insertCell(2).textContent = member.email;
                        row.insertCell(3).textContent = dateStr;
                    }
                }
            }
        }
        
        // CSV ë‹¤ìš´ë¡œë“œ
        function downloadCSV() {
            if (members.length === 0) {
                alert('ë‹¤ìš´ë¡œë“œí•  íšŒì› ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            var csv = '\uFEFF';
            csv += 'No,ì´ë¦„,ì´ë©”ì¼,ê°€ì…ì¼ì‹œ\n';
            
            for (var i = 0; i < members.length; i++) {
                var member = members[i];
                var date = new Date(member.joinDate).toLocaleString('ko-KR');
                csv += (i + 1) + ',"' + member.name + '","' + member.email + '","' + date + '"\n';
            }
            
            var blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            var link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'KDVA_íšŒì›ëª©ë¡_' + new Date().toISOString().split('T')[0] + '.csv';
            link.click();
        }
        
        // ì—‘ì…€ ë‹¤ìš´ë¡œë“œ
        function downloadExcel() {
            if (members.length === 0) {
                alert('ë‹¤ìš´ë¡œë“œí•  íšŒì› ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            var html = '<html><head><meta charset="utf-8"></head><body><table border="1">';
            html += '<tr><th>No</th><th>ì´ë¦„</th><th>ì´ë©”ì¼</th><th>ê°€ì…ì¼ì‹œ</th></tr>';
            
            for (var i = 0; i < members.length; i++) {
                var member = members[i];
                var date = new Date(member.joinDate).toLocaleString('ko-KR');
                html += '<tr><td>' + (i + 1) + '</td><td>' + member.name + '</td><td>' + member.email + '</td><td>' + date + '</td></tr>';
            }
            
            html += '</table></body></html>';
            
            var blob = new Blob(['\ufeff' + html], { type: 'application/vnd.ms-excel;charset=utf-8;' });
            var link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'KDVA_íšŒì›ëª©ë¡_' + new Date().toISOString().split('T')[0] + '.xls';
            link.click();
        }
        
        // DOM ë¡œë“œ ì™„ë£Œ í›„ ì‹¤í–‰
        document.addEventListener('DOMContentLoaded', function() {
            console.log('í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ');
            
            loadMembers();
            
            // ê°€ì… í¼
            var signupForm = document.getElementById('signupForm');
            if (signupForm) {
                signupForm.onsubmit = function(e) {
                    e.preventDefault();
                    console.log('ê°€ì… ì œì¶œ');
                    
                    var nameInput = document.getElementById('name');
                    var emailInput = document.getElementById('email');
                    
                    var name = nameInput.value.trim();
                    var email = emailInput.value.trim();
                    
                    if (!name || !email) {
                        alert('ì´ë¦„ê³¼ ì´ë©”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                        return false;
                    }
                    
                    // ì¤‘ë³µ ì²´í¬
                    for (var i = 0; i < members.length; i++) {
                        if (members[i].email === email) {
                            alert('ì´ë¯¸ ë“±ë¡ëœ ì´ë©”ì¼ì…ë‹ˆë‹¤.');
                            return false;
                        }
                    }
                    
                    var newMember = {
                        id: members.length + 1,
                        name: name,
                        email: email,
                        joinDate: new Date().toISOString()
                    };
                    
                    members.push(newMember);
                    saveMembers();
                    
                    console.log('íšŒì› ì¶”ê°€:', newMember);
                    
                    signupForm.reset();
                    
                    var successMsg = document.getElementById('successMessage');
                    if (successMsg) {
                        successMsg.style.display = 'block';
                        setTimeout(function() {
                            successMsg.style.display = 'none';
                        }, 3000);
                    }
                    
                    return false;
                };
            }
            
            // ê´€ë¦¬ì ë¡œê·¸ì¸ ë§í¬
            var adminLink = document.getElementById('adminLink');
            if (adminLink) {
                adminLink.onclick = function(e) {
                    e.preventDefault();
                    console.log('ê´€ë¦¬ì ë¡œê·¸ì¸ í´ë¦­');
                    showPage('loginPage');
                    return false;
                };
            }
            
            // ê°€ì… í˜ì´ì§€ë¡œ
            var backToSignup = document.getElementById('backToSignup');
            if (backToSignup) {
                backToSignup.onclick = function(e) {
                    e.preventDefault();
                    console.log('ê°€ì… í˜ì´ì§€ë¡œ');
                    showPage('signupPage');
                    return false;
                };
            }
            
            // ë¡œê·¸ì¸ í¼
            var loginForm = document.getElementById('loginForm');
            if (loginForm) {
                loginForm.onsubmit = function(e) {
                    e.preventDefault();
                    console.log('ë¡œê·¸ì¸ ì‹œë„');
                    
                    var passwordInput = document.getElementById('adminPassword');
                    var password = passwordInput.value;
                    
                    if (password === ADMIN_PASSWORD) {
                        console.log('ë¡œê·¸ì¸ ì„±ê³µ');
                        showPage('adminPage');
                        setTimeout(function() {
                            updateDashboard();
                        }, 100);
                    } else {
                        console.log('ë¡œê·¸ì¸ ì‹¤íŒ¨');
                        alert('ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.');
                    }
                    
                    passwordInput.value = '';
                    return false;
                };
            }
            
            // ë¡œê·¸ì•„ì›ƒ
            var logoutBtn = document.getElementById('logoutBtn');
            if (logoutBtn) {
                logoutBtn.onclick = function(e) {
                    e.preventDefault();
                    console.log('ë¡œê·¸ì•„ì›ƒ');
                    showPage('signupPage');
                    return false;
                };
            }
            
            // CSV ë‹¤ìš´ë¡œë“œ
            var csvBtn = document.getElementById('downloadCSV');
            if (csvBtn) {
                csvBtn.onclick = function(e) {
                    e.preventDefault();
                    downloadCSV();
                    return false;
                };
            }
            
            // ì—‘ì…€ ë‹¤ìš´ë¡œë“œ
            var excelBtn = document.getElementById('downloadExcel');
            if (excelBtn) {
                excelBtn.onclick = function(e) {
                    e.preventDefault();
                    downloadExcel();
                    return false;
                };
            }
            
            console.log('ì´ˆê¸°í™” ì™„ë£Œ');
        });
    </script>
</body>
</html>
